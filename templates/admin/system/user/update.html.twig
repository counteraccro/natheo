{% extends 'admin/admin_base.html.twig' %}

{% block title %}{{ 'user.page_update_title' | trans({'login' : user.login}, 'user') }}{% endblock %}

{% block body %}

    {{ breadcrumb(breadcrumb) }}

    <h1 class="head-title">
        <svg class="w-7 h-7" style="color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        {{ 'user.page_update_title_h1' | trans({'login' : user.login}, 'user') }}</h1>

    <p class="text-sm text-[var(--text-secondary)] mb-3">
        {{ 'user.page_update_description' | trans({}, 'user') }}
    </p>

    {{ form_start(form) }}
    <div class="card rounded-lg p-6 mb-4 mt-4">
        <div class="border-b-1 border-b-[var(--border-color)] mb-4">
            <h2 class="text-lg font-bold text-[var(--text-primary)]"> {{ 'user.page_add.profil' | trans({}, 'user') }}</h2>
            <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]"> {{ 'user.page_add.profil.description' | trans({}, 'user') }} </p>
        </div>

        <div class="form-group">
            <label class="form-label">{{ field_label(form.email) }}</label>
            <input type="email" class="form-input" value="{{ field_value(form.email) }}"
                   placeholder="{{ field_label(form.email) }}" required
                   id="{{ field_id(form.email) }}" name="{{ field_name(form.email) }}">
            <span class="form-text">{{ field_help(form.email) }}</span>
        </div>

        {% if isSuperAdmin is same as false %}
        <div class="form-group">
            <label class="form-label">{{ field_label(form.roles) }}</label>
            <select class="form-input" id="{{ field_id(form.roles) }}" name="{{ field_name(form.roles) }}">
                {% for label, value in field_choices(form.roles) %}
                    <option value="{{ value }}">{{ label }}</option>
                {% endfor %}
            </select>
            <span class="form-text">{{ field_help(form.roles) }}</span>
        </div>
        {% endif %}

        {% if isSuperAdmin is same as false %}
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="{{ field_id(form.disabled) }}" name="{{ field_name(form.disabled) }}" {% if user.disabled is same as true %} checked {% endif %}>
            <label class="form-check-label" for="{{ field_id(form.disabled) }}">{{ field_label(form.disabled) }}</label>
        </div>
        <span class="form-text">{{ field_help(form.disabled) }}</span>
        {% endif %}
    </div>

    <div class="card rounded-lg p-6 mb-4 mt-4 pb-14">
        <div class="border-b-1 border-b-[var(--border-color)] mb-4">
            <h2 class="text-lg font-bold text-[var(--text-primary)]"> {{ 'user.page_add.personal_data' | trans({}, 'user') }}</h2>
            <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]"> {{ 'user.page_add.personal_data.description' | trans({}, 'user') }} </p>
        </div>

        <div class="form-group">
            <label class="form-label">{{ field_label(form.login) }}</label>
            <input type="text" class="form-input" value="{{ field_value(form.login) }}"
                   placeholder="{{ field_label(form.login) }}"
                   id="{{ field_id(form.login) }}" name="{{ field_name(form.login) }}">
            <span class="form-text">{{ field_help(form.login) }}</span>
        </div>

        <div class="form-group">
            <label class="form-label">{{ field_label(form.firstname) }}</label>
            <input type="text" class="form-input" value="{{ field_value(form.firstname) }}"
                   placeholder="{{ field_label(form.firstname) }}"
                   id="{{ field_id(form.firstname) }}" name="{{ field_name(form.firstname) }}">
            <span class="form-text">{{ field_help(form.firstname) }}</span>
        </div>

        <div class="form-group">
            <label class="form-label">{{ field_label(form.lastname) }}</label>
            <input type="text" class="form-input" value="{{ field_value(form.lastname) }}"
                   placeholder="{{ field_label(form.lastname) }}"
                   id="{{ field_id(form.lastname) }}" name="{{ field_name(form.lastname) }}">
            <span class="form-text">{{ field_help(form.lastname) }}</span>
        </div>

        {{ form(form) }}
        <span class="form-text float-start">{{ 'user.page_update.last_update' | trans({}, 'user') }} {{ diff_now(user.updateAt) }}</span>
    </div>

    <div class="card rounded-lg p-6 mb-4 mt-4">
        <div class="border-b-1 border-b-[var(--border-color)] mb-4">
            <h2 class="text-lg font-bold text-[var(--text-primary)]">  {{ 'user.page_update.action' | trans({}, 'user') }}</h2>
            <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]"> {{ 'user.page_update.action.description' | trans({}, 'user') }} </p>
        </div>

        {% if isSuperAdmin is same as false %}
            {% if user.disabled %}
                <div class="alert alert-warning-bordered mt-2">
                    <svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    <div class="alert-content">
                    <div class="alert-title"> {{ 'user.page_update.info.warning' | trans({}, 'user') }}</div>
                     <div class="alert-message"> {{ 'user.page_update.info.user_disabled' | trans({}, 'user') }}</div>
                    </div>

                </div>
            {% else %}
                <div class="mb-3">
                <h3 class="text-sm font-bold text-[var(--text-primary)]">{{ 'user.page_update.reset_password' | trans({}, 'user') }}</h3>
                <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]">{{ 'user.page_update.reset_password.description' | trans({}, 'user') }}</p>
                <a href="{{ path('admin_user_reset_password', {'id' : user.id}) }}" class="btn btn-sm btn-secondary">
                    <svg class="icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.7141 15h4.268c.4043 0 .732-.3838.732-.8571V3.85714c0-.47338-.3277-.85714-.732-.85714H6.71411c-.55228 0-1 .44772-1 1v4m10.99999 7v-3h3v3h-3Zm-3 6H6.71411c-.55228 0-1-.4477-1-1 0-1.6569 1.34315-3 3-3h2.99999c1.6569 0 3 1.3431 3 3 0 .5523-.4477 1-1 1Zm-1-9.5c0 1.3807-1.1193 2.5-2.5 2.5s-2.49999-1.1193-2.49999-2.5S8.8334 9 10.2141 9s2.5 1.1193 2.5 2.5Z"/>
                    </svg>

                    {{ 'user.page_update.reset_password.btn' | trans({}, 'user') }}</a>
                </div>


        <h3 class="text-sm font-bold text-[var(--text-primary)]">{{ 'user.page_update.connecte_to' | trans({}, 'user') }}</h3>
                <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]">{{ 'user.page_update.connecte_to.description' | trans({'login' : user.login}, 'user') }}</p>
                <a href="{{ path('admin_user_switch', {'user' : user.email}) }}" class="btn btn-sm btn-success">
                    <svg class="icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 19h4a1 1 0 0 0 1-1v-1a3 3 0 0 0-3-3h-2m-2.236-4a3 3 0 1 0 0-4M3 18v-1a3 3 0 0 1 3-3h4a3 3 0 0 1 3 3v1a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1Zm8-10a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
                    </svg>

                    {{ 'user.page_update.connecte_to.btn' | trans({'login' : user.login}, 'user') }}</a>
            {% endif %}
        {% else %}
            <p class="text-danger">
                <i>{{ 'user.page_update.info_role_super_admin' | trans({}, 'user') | raw }}</i></p>
        {% endif %}
    </div>

    <div class="card rounded-lg p-6 mb-4 mt-4">
        <div class="border-b-1 border-b-[var(--border-color)] mb-4">
            <h2 class="text-lg font-bold text-[var(--text-primary)]">   {{ 'user.page_update.information' | trans({}, 'user') }}</h2>
            <p class="text-sm mt-1 mb-3 text-[var(--text-secondary)]"> {{ 'user.page_update.information.description' | trans({}, 'user') }} </p>
        </div>

        <svg class="w-6 h-6 float-start me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path fill="currentColor" d="M4 9.05H3v2h1v-2Zm16 2h1v-2h-1v2ZM10 14a1 1 0 1 0 0 2v-2Zm4 2a1 1 0 1 0 0-2v2Zm-3 1a1 1 0 1 0 2 0h-2Zm2-4a1 1 0 1 0-2 0h2Zm-2-5.95a1 1 0 1 0 2 0h-2Zm2-3a1 1 0 1 0-2 0h2Zm-7 3a1 1 0 0 0 2 0H6Zm2-3a1 1 0 1 0-2 0h2Zm8 3a1 1 0 1 0 2 0h-2Zm2-3a1 1 0 1 0-2 0h2Zm-13 3h14v-2H5v2Zm14 0v12h2v-12h-2Zm0 12H5v2h14v-2Zm-14 0v-12H3v12h2Zm0 0H3a2 2 0 0 0 2 2v-2Zm14 0v2a2 2 0 0 0 2-2h-2Zm0-12h2a2 2 0 0 0-2-2v2Zm-14-2a2 2 0 0 0-2 2h2v-2Zm-1 6h16v-2H4v2ZM10 16h4v-2h-4v2Zm3 1v-4h-2v4h2Zm0-9.95v-3h-2v3h2Zm-5 0v-3H6v3h2Zm10 0v-3h-2v3h2Z"/>
        </svg>
        <span class="text-sm text-[var(--text-secondary)]">{{ 'user.page_update.created' | trans({}, 'user') }} : {{ diff_now(user.createdAt) }}</span>
        <br/>
        <svg class="w-6 h-6 float-start me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 10h16m-8-3V4M7 7V4m10 3V4M5 20h14a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Zm3-7h.01v.01H8V13Zm4 0h.01v.01H12V13Zm4 0h.01v.01H16V13Zm-8 4h.01v.01H8V17Zm4 0h.01v.01H12V17Zm4 0h.01v.01H16V17Z"/>
        </svg>
        <span class="text-sm text-[var(--text-secondary)]">{{ 'user.page_update.last_update' | trans({}, 'user') }} : {{ diff_now(user.updateAt) }}</span>
        <br />
        <svg class="w-6 h-6 float-start me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
        </svg>
        <span class="text-sm text-[var(--text-secondary)]">{{ 'user.page_update.last_connexion' | trans({}, 'user') }} : {{ diff_now(lastConnexion) }}</span>
    </div>
    

    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div id="toast-alert-update-user" class="fixed flex items-center w-full max-w-xs p-4 text-body bg-neutral-primary-soft rounded-base shadow-xs border border-default top-5 end-5 border-[var(--alert-success-border)] bg-white" role="alert">
                <div
                    class="inline-flex items-center justify-center shrink-0 w-8 h-8 rounded-lg bg-[var(--alert-success-bg)] text-[var(--alert-success-text)]"
                >
                    <svg
                        class="w-5 h-5"
                        aria-hidden="true"
                        xmlns="http://www.w3.org/2000/svg"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                    >
                        <path
                            d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"
                        />
                    </svg>
                    <span class="sr-only">Check icon</span>
                </div>
                <div class="ms-3 text-xs font-normal text-[var(--alert-success-text)]">
                    {{ message }}
                </div>
                <button
                    type="button" id="close-flash"
                    class="ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700"
                    aria-label="Close"
                >
                    <span class="sr-only">Close</span>
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path
                            stroke="currentColor"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                        />
                    </svg>
                </button>
            </div>
        {% endfor %}
    {% endfor %}

    <script language='javascript'>

        setTimeout(() => {
            let element = document.getElementById('toast-alert-update-user');
            element.classList.add('hidden');
        }, 3000);
    </script>

{% endblock %}